# Future Database Expansion Strategy (Supabase)

This project is designed to be **API-First**. Currently, it reads from local MDX files (`content/posts`), but it is ready to switch to Supabase (PostgreSQL) when you need mobile synchronization or a CMS dashboard.

## 1. Database Schema
Run this SQL in your Supabase SQL Editor:

```sql
-- 1. Create the posts table
create table posts (
  id bigint generated by default as identity primary key,
  slug text not null unique,
  title text not null,
  description text,
  date date not null,
  content text not null, -- Stores the raw MDX string
  tags text[] default '{}',
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 2. Enable Row Level Security (Security best practice)
alter table posts enable row level security;

-- 3. Create a policy that allows EVERYONE to READ data
create policy "Public posts are viewable by everyone"
  on posts for select
  using (true);

-- 4. Create a policy that allows ONLY YOU to INSERT/UPDATE (optional, requires Auth)
-- create policy "Authenticated users can insert"
--   on posts for insert
--   to authenticated
--   with check (true);
```

## 2. Switch Data Source
When you are ready, update `src/lib/posts.ts` to use the Supabase Client instead of `fs` (FileSystem).

**Install Supabase Client:**
```bash
npm install @supabase/supabase-js
```

**New `src/lib/posts.ts` Implementation:**
```typescript
import { createClient } from '@supabase/supabase-js';

const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
);

export async function getPosts() {
  const { data } = await supabase
    .from('posts')
    .select('slug, title, date, description, tags')
    .order('date', { ascending: false });
    
  return data || [];
}

export async function getPostBySlug(slug: string) {
  const { data } = await supabase
    .from('posts')
    .select('*')
    .eq('slug', slug)
    .single();
    
  return data;
}
```

## 3. Android Integration
Your Android App should **NOT** use the Supabase Client directly (unless you want to). 
Instead, continue using the API Endpoint we built:

- **Endpoint**: `GET https://your-blog.com/api/posts`
- **Response**: JSON Array of posts.

This keeps your Mobile App decoupled from your Database choice.
